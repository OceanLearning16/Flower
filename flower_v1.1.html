<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, maximum-scale=1.0, minimum-scale=1.0">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="format-detection" content="telephone=no">
    
    <!-- å¾®ä¿¡åˆ†äº«é…ç½® -->
    <meta property="og:title" content="ğŸŒ¸ çˆ±å¿ƒèŠ±ç¯æ¸¸æˆ ğŸŒ¸">
    <meta property="og:description" content="ä¸€ä¸ªæ¸©é¦¨æµªæ¼«çš„å°æ¸¸æˆï¼Œç¼–ç»‡å±äºæˆ‘ä»¬çš„çˆ±å¿ƒèŠ±ç¯ğŸ’–">
    <meta property="og:image" content="https://ä½ çš„åŸŸå.com/share-image.jpg">
    <meta property="og:url" content="https://ä½ çš„åŸŸå.com/">
    
    <title>ğŸŒ¸ çˆ±å¿ƒèŠ±ç¯æ¸¸æˆ ğŸŒ¸</title>
    
    <!-- å¾®ä¿¡JS-SDK -->
    <script src="https://res.wx.qq.com/open/js/jweixin-1.6.0.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif;
            background: linear-gradient(135deg, #ffeef8 0%, #f8e8ff 25%, #e8f5ff 50%, #fff0f5 75%, #fdf2f8 100%);
            min-height: 100vh;
            user-select: none;
            color: #666;
            touch-action: manipulation;
            -webkit-touch-callout: none;
            -webkit-user-select: none;
            -webkit-tap-highlight-color: transparent;
            overflow-x: hidden;
        }

        /* æ¨±èŠ±é£˜è½æ•ˆæœ */
        .sakura-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1;
        }

        .sakura {
            position: absolute;
            font-size: 16px;
            animation: sakuraFall linear infinite;
            opacity: 0.7;
        }

        @keyframes sakuraFall {
            from {
                transform: translateY(-100px) rotate(0deg);
                opacity: 0.7;
            }
            to {
                transform: translateY(100vh) rotate(360deg);
                opacity: 0;
            }
        }

        /* æ¸¸æˆå®¹å™¨ */
        .game-container {
            position: relative;
            min-height: 100vh;
            min-height: calc(var(--vh, 1vh) * 100);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            padding: 10px;
            z-index: 10;
        }

        /* æ¸¸æˆç•Œé¢ */
        .game-screen {
            background: rgba(255, 255, 255, 0.85);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border-radius: 25px;
            padding: 30px 20px;
            text-align: center;
            box-shadow: 0 8px 32px rgba(255, 182, 193, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.6);
            max-width: 450px;
            width: 95%;
            min-height: 400px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            transition: all 0.3s ease;
        }

        .game-title {
            font-size: 2.2rem;
            color: #d63384;
            margin-bottom: 15px;
            font-weight: 300;
            letter-spacing: 2px;
        }

        .game-subtitle {
            font-size: 1rem;
            color: #8b5a83;
            margin-bottom: 30px;
            font-weight: 300;
        }

        /* å¼€å§‹ç•Œé¢ */
        .start-screen {
            animation: fadeIn 1.5s ease-out;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .name-input {
            width: 100%;
            max-width: 280px;
            padding: 15px 20px;
            font-size: 16px; /* é˜²æ­¢iOSç¼©æ”¾ */
            border: 2px solid #f8bbd9;
            border-radius: 20px;
            background: #fdf2f8;
            text-align: center;
            outline: none;
            margin-bottom: 25px;
            transition: all 0.3s ease;
            color: #666;
            -webkit-appearance: none;
            -webkit-border-radius: 20px;
        }

        .name-input:focus {
            border-color: #e879f9;
            background: #fef7ff;
            transform: scale(1.02);
        }

        /* æ¸¸æˆæŒ‰é’® */
        .game-btn {
            padding: 15px 28px;
            margin: 8px;
            font-size: 1rem;
            color: #8b5a83;
            border: 2px solid #f8bbd9;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            background: #fdf2f8;
            font-weight: 300;
            letter-spacing: 1px;
            -webkit-tap-highlight-color: transparent;
            touch-action: manipulation;
        }

        .game-btn:hover, .game-btn:active {
            background: #f3e8ff;
            border-color: #e879f9;
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(232, 121, 249, 0.2);
        }

        /* é€‰æ‹©æŒ‰é’® */
        .choice-btn {
            background: #fef7ff;
            border: 1px solid #f8bbd9;
            margin: 8px auto;
            padding: 12px 16px;
            font-size: 0.95rem;
            border-radius: 15px;
            display: block;
            width: 100%;
            max-width: 350px;
            cursor: pointer;
            -webkit-tap-highlight-color: transparent;
            touch-action: manipulation;
            transition: all 0.3s ease;
        }

        .choice-btn:hover, .choice-btn:active {
            background: #f3e8ff;
            border-color: #e879f9;
            transform: translateY(-1px);
        }

        .choice-btn.correct {
            background: #dcfce7;
            border-color: #86efac;
            animation: gentleCorrect 0.6s ease;
        }

        @keyframes gentleCorrect {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        /* é—®é¢˜æ˜¾ç¤º */
        .question {
            font-size: 1.1rem;
            color: #8b5a83;
            margin-bottom: 25px;
            line-height: 1.8;
            min-height: 80px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 300;
        }

        /* è¿›åº¦æ¡ */
        .progress-container {
            width: 100%;
            height: 8px;
            background: #f8bbd9;
            border-radius: 4px;
            margin: 20px 0;
            overflow: hidden;
        }

        .progress-bar {
            height: 100%;
            background: linear-gradient(90deg, #f8bbd9, #e879f9);
            border-radius: 4px;
            transition: width 0.8s ease;
        }

        /* çˆ±å¿ƒèŠ±å›­ */
        .heart-garden {
            margin: 20px 0;
        }

        .heart-grid {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 8px;
            max-width: 250px;
            margin: 20px auto;
            position: relative;
        }

        /* çˆ±å¿ƒå½¢çŠ¶çš„ç½‘æ ¼å¸ƒå±€ */
        .heart-pot {
            aspect-ratio: 1;
            background: linear-gradient(135deg, #fef7ff, #f3e8ff);
            border: 2px solid #f8bbd9;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            cursor: pointer;
            transition: all 0.3s ease;
            -webkit-tap-highlight-color: transparent;
            touch-action: manipulation;
        }

        /* éšè—æŸäº›ä½ç½®æ¥å½¢æˆçˆ±å¿ƒå½¢çŠ¶ */
        .heart-pot:nth-child(1), .heart-pot:nth-child(5), 
        .heart-pot:nth-child(21), .heart-pot:nth-child(22), 
        .heart-pot:nth-child(23), .heart-pot:nth-child(24), 
        .heart-pot:nth-child(25) {
            visibility: hidden;
        }

        .heart-pot:hover, .heart-pot:active {
            transform: scale(1.1);
            border-color: #e879f9;
        }

        .heart-pot.bloomed {
            background: linear-gradient(135deg, #fce7f3, #f3e8ff);
            animation: bloom 0.8s ease;
            border-color: #e879f9;
        }

        @keyframes bloom {
            0% { transform: scale(1); }
            50% { transform: scale(1.2); }
            100% { transform: scale(1); }
        }

        /* æ”¶é›†æ˜Ÿæ˜Ÿæ¸¸æˆ */
        .star-field {
            position: relative;
            height: 200px;
            background: linear-gradient(135deg, #fef7ff, #f8fafc);
            border: 2px dashed #f8bbd9;
            border-radius: 15px;
            margin: 20px 0;
            overflow: hidden;
        }

        .falling-star {
            position: absolute;
            font-size: 24px;
            cursor: pointer;
            animation: starFloat 6s linear;
            transition: transform 0.2s ease;
            -webkit-tap-highlight-color: transparent;
            touch-action: manipulation;
        }

        .falling-star:hover, .falling-star:active {
            transform: scale(1.3);
        }

        @keyframes starFloat {
            from { 
                transform: translateY(-40px) translateX(0);
                opacity: 0.9;
            }
            to { 
                transform: translateY(240px) translateX(30px);
                opacity: 0.3;
            }
        }

        /* é…å¯¹æ¸¸æˆ */
        .memory-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 8px;
            max-width: 280px;
            margin: 20px auto;
        }

        .memory-card {
            aspect-ratio: 1;
            background: #fef7ff;
            border: 2px solid #f8bbd9;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            cursor: pointer;
            transition: all 0.3s ease;
            -webkit-tap-highlight-color: transparent;
            touch-action: manipulation;
        }

        .memory-card:hover, .memory-card:active {
            transform: scale(1.05);
            border-color: #e879f9;
        }

        .memory-card.flipped {
            background: #f3e8ff;
            border-color: #e879f9;
        }

        .memory-card.matched {
            background: #dcfce7;
            border-color: #86efac;
            animation: gentleMatch 0.5s ease;
        }

        @keyframes gentleMatch {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }

        /* ç»“æœç•Œé¢ */
        .result-screen {
            animation: softAppear 1.2s ease-out;
        }

        @keyframes softAppear {
            0% { opacity: 0; transform: scale(0.8); }
            100% { opacity: 1; transform: scale(1); }
        }

        .love-percentage {
            font-size: 3.5rem;
            color: #e879f9;
            margin: 20px 0;
            font-weight: 300;
            animation: gentlePulse 3s ease-in-out infinite;
        }

        @keyframes gentlePulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        .final-message {
            font-size: 1rem;
            color: #8b5a83;
            line-height: 1.8;
            margin: 20px 0;
            font-weight: 300;
        }

        /* å®Œæ•´èŠ±ç¯æ˜¾ç¤º */
        .complete-wreath {
            margin: 30px 0;
            animation: wreathComplete 2.5s ease-out;
            filter: drop-shadow(0 0 20px rgba(232, 121, 249, 0.3));
        }

        .complete-heart-wreath {
            display: grid;
            grid-template-columns: repeat(9, 1fr);
            gap: 3px;
            font-size: 1.8rem;
            max-width: 400px;
            margin: 0 auto;
            padding: 20px;
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.1), rgba(255, 240, 245, 0.1));
            border-radius: 25px;
            backdrop-filter: blur(10px);
            border: 2px solid rgba(232, 121, 249, 0.2);
        }

        .complete-heart-wreath span {
            display: flex;
            align-items: center;
            justify-content: center;
            animation: sparkleGlow 3s ease-in-out infinite;
        }

        .complete-heart-wreath span:nth-child(4n) {
            animation-delay: 0.5s;
        }

        .complete-heart-wreath span:nth-child(4n+1) {
            animation-delay: 1s;
        }

        .complete-heart-wreath span:nth-child(4n+2) {
            animation-delay: 1.5s;
        }

        @keyframes sparkleGlow {
            0%, 100% { transform: scale(1); filter: brightness(1); }
            50% { transform: scale(1.1); filter: brightness(1.3) drop-shadow(0 0 10px rgba(232, 121, 249, 0.6)); }
        }

        @keyframes wreathComplete {
            0% { 
                transform: scale(0.3) rotate(-180deg); 
                opacity: 0; 
                filter: blur(10px) drop-shadow(0 0 0 rgba(232, 121, 249, 0)); 
            }
            70% { 
                transform: scale(1.1) rotate(10deg); 
                opacity: 1; 
                filter: blur(0) drop-shadow(0 0 30px rgba(232, 121, 249, 0.6)); 
            }
            100% { 
                transform: scale(1) rotate(0deg); 
                opacity: 1; 
                filter: blur(0) drop-shadow(0 0 20px rgba(232, 121, 249, 0.3)); 
            }
        }

        /* ç‰¹æ•ˆ */
        .sparkles {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1000;
        }

        .sparkle {
            position: absolute;
            font-size: 20px;
            animation: sparkleFloat 3s ease-out forwards;
        }

        @keyframes sparkleFloat {
            0% { transform: scale(1) rotate(0deg); opacity: 1; }
            100% { transform: scale(2) rotate(180deg); opacity: 0; }
        }

        @keyframes gentleFloat {
            0% { opacity: 1; transform: translate(-50%, -50%) scale(1); }
            100% { opacity: 0; transform: translate(-50%, -120%) scale(1.2); }
        }

        /* éŸ³ä¹æ§åˆ¶æŒ‰é’® */
        .music-control {
            position: fixed;
            top: 15px;
            right: 15px;
            z-index: 1000;
            background: rgba(255, 255, 255, 0.9);
            border: 2px solid #f8bbd9;
            border-radius: 50%;
            width: 45px;
            height: 45px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 1.1rem;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            -webkit-tap-highlight-color: transparent;
            user-select: none;
        }

        .music-control:hover {
            background: #f3e8ff;
            border-color: #e879f9;
            transform: scale(1.1);
        }

        .music-control.playing {
            animation: musicPulse 2s ease-in-out infinite;
        }

        /* éšè—ç±» */
        .hidden {
            display: none !important;
        }

        /* åˆ†äº«æŒ‰é’® */
        .share-btn {
            background: linear-gradient(45deg, #ff6b6b, #ee5a52);
            color: white;
            border: none;
            margin: 5px;
        }

        .share-btn:hover, .share-btn:active {
            background: linear-gradient(45deg, #ee5a52, #d63031);
            transform: translateY(-2px);
        }

        /* åˆ†äº«é¢æ¿ */
        .share-panel {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(15px);
            border-radius: 20px 20px 0 0;
            padding: 20px;
            transform: translateY(100%);
            transition: transform 0.3s ease;
            z-index: 2000;
            box-shadow: 0 -5px 20px rgba(0, 0, 0, 0.1);
        }

        .share-panel.show {
            transform: translateY(0);
        }

        .share-options {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 15px;
            margin-top: 15px;
        }

        .share-option {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 15px 10px;
            background: #f8f9fa;
            border-radius: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            color: #666;
        }

        .share-option:hover {
            background: #e9ecef;
            transform: translateY(-2px);
        }

        .share-option-icon {
            font-size: 2rem;
            margin-bottom: 8px;
        }

        .share-option-text {
            font-size: 0.8rem;
            text-align: center;
        }

        /* éŸ³é¢‘å…ƒç´ éšè— */
        .audio-hidden {
            display: none;
        }

        /* é®ç½©å±‚ */
        .overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.3);
            z-index: 1500;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }

        .overlay.show {
            opacity: 1;
            visibility: visible;
        }

        /* å“åº”å¼ */
        @media (max-width: 768px) {
            .game-title { font-size: 1.6rem; }
            .game-subtitle { font-size: 0.9rem; }
            .name-input { width: 90%; max-width: 250px; }
            .game-screen { padding: 20px 15px; min-height: 350px; }
            .heart-grid, .memory-grid { max-width: 180px; }
            .complete-heart-wreath { max-width: 280px; font-size: 1.2rem; }
            .question { font-size: 1rem; min-height: 60px; }
            .choice-btn { font-size: 0.9rem; padding: 10px 12px; }
            .music-control { width: 40px; height: 40px; font-size: 1rem; top: 10px; right: 10px; }
        }

        @media (max-width: 480px) {
            .game-title { font-size: 1.4rem; }
            .game-screen { padding: 15px 10px; }
            .heart-grid, .memory-grid { max-width: 160px; }
            .complete-heart-wreath { max-width: 240px; font-size: 1rem; }
            .star-field { height: 150px; }
        }

        /* iOS Safari é€‚é… */
        @supports (-webkit-appearance: none) {
            .game-screen {
                -webkit-backdrop-filter: blur(10px);
            }
            
            input {
                -webkit-appearance: none;
                border-radius: 0;
            }
        }
    </style>
</head>
<body>
    <!-- æ¨±èŠ±é£˜è½ -->
    <div class="sakura-container" id="sakuraContainer"></div>
    
    <!-- é—ªå…‰ç‰¹æ•ˆ -->
    <div class="sparkles" id="sparkles"></div>
    
    <!-- éŸ³ä¹æ§åˆ¶ -->
    <div class="music-control" id="musicControl" onclick="toggleMusic()">ğŸµ</div>
    
    <!-- éŸ³é¢‘æ–‡ä»¶ -->
    <audio id="bgMusic" class="audio-hidden" loop>
        <source src="data:audio/mpeg;base64,SUQzBAAAAAAAI1RTU0UAAAAPAAADTGF2ZjU4Ljc2LjEwMAAAAAAAAAAAAAAA//tQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAWGluZwAAAA8AAAACAAABIADAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDA//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AAAA5UxBTUUzLjEwMAG8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAANAAAAAAAAAAAAAEgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA//tQxAAaAAAGkAAAAIAAANIAAAASqqhUpACAkAAAkAAABEAAAAAT2bIlP" type="audio/mpeg">
        ä½ çš„æµè§ˆå™¨ä¸æ”¯æŒéŸ³é¢‘æ’­æ”¾ã€‚
    </audio>
    
    <audio id="clickSound" class="audio-hidden">
        <source src="data:audio/wav;base64,UklGRnoGAABXQVZFZm10IBAAAAABAAEAQB8AAEAfAAABAAgAZGF0YQoGAACBhYqFbF1fdJivrJBhNjVgodDbq2EcBj+a2/LDciUFLIHO8tiJNwgZaLvt559NEAxQp+PwtmMcBjiR1/LMeSwFJHfH8N2QQAoUXrTp66hVFAxIouTyvmEbBjiR2O/PeScEJ4DJ8N6SQgoVX7Pp6alWFAxIoeHuvGEaByuR2e/PeScEJoPI792TQgoUX7Lq6qpXFQs=" type="audio/wav">
    </audio>
    
    <audio id="successSound" class="audio-hidden">
        <source src="data:audio/wav;base64,UklGRnoGAABXQVZFZm10IBAAAAABAAEAQB8AAEAfAAABAAgAZGF0YQoGAACBhYqFbF1fdJivrJBhNjVgodDbq2EcBj+a2/LDciUFLIHO8tiJNwgZaLvt559NEAxQp+PwtmMcBjiR1/LMeSwFJHfH8N2QQAoUXrTp66hVFAxIouTyvmEbBzqVg0" type="audio/wav">
    </audio>
    
    <div class="game-container">
        <!-- å¼€å§‹ç•Œé¢ -->
        <div class="game-screen" id="startScreen">
            <div class="start-screen">
                <h1 class="game-title">ğŸŒ¸ çˆ±å¿ƒèŠ±ç¯ ğŸŒ¸</h1>
                <p class="game-subtitle">æ¯å®Œæˆä¸€ä¸ªå°æ¸¸æˆï¼Œå°±èƒ½è·å¾—ç¾ä¸½çš„èŠ±æœµ<br>è®©æˆ‘ä»¬ä¸€èµ·ç¼–ç»‡å±äºæˆ‘ä»¬çš„çˆ±å¿ƒèŠ±ç¯</p>
                <input type="text" id="nameInput" class="name-input" placeholder="è¾“å…¥é‚£ä¸ªç‰¹åˆ«çš„äººçš„åå­—..." maxlength="8">
                <br>
                <button class="game-btn" onclick="startGame()">å¼€å§‹ç¼–ç»‡èŠ±ç¯ âœ¨</button>
            </div>
        </div>

        <!-- æ¸¸æˆä¸»ç•Œé¢ -->
        <div class="game-screen hidden" id="gameScreen">
            <div class="progress-container">
                <div class="progress-bar" id="progressBar" style="width: 0%"></div>
            </div>
            
            <div class="question" id="questionText"></div>
            <div id="gameContent"></div>
            
            <button class="game-btn hidden" id="nextBtn" onclick="nextQuestion()">ç»§ç»­ç¼–ç»‡ â†’</button>
        </div>

        <!-- ç»“æœç•Œé¢ -->
        <div class="game-screen hidden" id="resultScreen">
            <div class="result-screen">
                <h2 class="game-title">ğŸŒº èŠ±ç¯å®Œæˆï¼</h2>
                <div class="complete-wreath" id="completeWreath"></div>
                <div class="love-percentage">100%</div>
                <div class="final-message" id="finalMessage"></div>
                <button class="game-btn share-btn" onclick="showSharePanel()">åˆ†äº«è¿™ä»½ç¾å¥½ ğŸ’Œ</button>
                <button class="game-btn" onclick="restart()">é‡æ–°ç¼–ç»‡ ğŸ”„</button>
            </div>
        </div>
    </div>

    <!-- é®ç½©å±‚ -->
    <div class="overlay" id="overlay" onclick="hideSharePanel()"></div>

    <!-- åˆ†äº«é¢æ¿ -->
    <div class="share-panel" id="sharePanel">
        <button class="share-panel-close" onclick="hideSharePanel()">Ã—</button>
        <h3 style="text-align: center; margin: 0; color: #8b5a83;">åˆ†äº«è¿™ä»½ç¾å¥½</h3>
        <div class="share-options">
            <div class="share-option" onclick="shareToWechat()">
                <div class="share-option-icon">ğŸ’¬</div>
                <div class="share-option-text">å¾®ä¿¡å¥½å‹</div>
            </div>
            <div class="share-option" onclick="shareToMoments()">
                <div class="share-option-icon">ğŸ“±</div>
                <div class="share-option-text">æœ‹å‹åœˆ</div>
            </div>
            <div class="share-option" onclick="copyLink()">
                <div class="share-option-icon">ğŸ”—</div>
                <div class="share-option-text">å¤åˆ¶é“¾æ¥</div>
            </div>
            <div class="share-option" onclick="shareToQQ()">
                <div class="share-option-icon">ğŸ§</div>
                <div class="share-option-text">QQå¥½å‹</div>
            </div>
        </div>
    </div>

    <script>
        // å¾®ä¿¡åˆ†äº«é…ç½®
        const shareConfig = {
            title: 'ğŸŒ¸ çˆ±å¿ƒèŠ±ç¯æ¸¸æˆ ğŸŒ¸',
            desc: 'æˆ‘ä»¬ä¸€èµ·ç¼–ç»‡äº†ç¾ä¸½çš„çˆ±å¿ƒèŠ±ç¯ï¼Œæ¯ä¸€æœµèŠ±éƒ½å……æ»¡äº†çˆ±æ„ğŸ’–',
            link: window.location.href,
            imgUrl: 'https://ä½ çš„åŸŸå.com/share-image.jpg', // éœ€è¦æ›¿æ¢ä¸ºä½ çš„åˆ†äº«å›¾ç‰‡
            success: function () {
                console.log('åˆ†äº«æˆåŠŸ');
            },
            cancel: function () {
                console.log('å–æ¶ˆåˆ†äº«');
            }
        };

        // åˆå§‹åŒ–å¾®ä¿¡åˆ†äº«
        function initWechatShare() {
            // è¿™é‡Œéœ€è¦ä»åç«¯è·å–å¾®ä¿¡JS-SDKçš„é…ç½®å‚æ•°
            // åŒ…æ‹¬ appId, timestamp, nonceStr, signature
            
            // ç¤ºä¾‹é…ç½®ï¼ˆéœ€è¦æ›¿æ¢ä¸ºçœŸå®çš„é…ç½®ï¼‰
            wx.config({
                debug: false, // å¼€å¯è°ƒè¯•æ¨¡å¼
                appId: 'ä½ çš„å¾®ä¿¡å…¬ä¼—å·AppId', // å¿…å¡«ï¼Œå…¬ä¼—å·çš„å”¯ä¸€æ ‡è¯†
                timestamp: '', // å¿…å¡«ï¼Œç”Ÿæˆç­¾åçš„æ—¶é—´æˆ³
                nonceStr: '', // å¿…å¡«ï¼Œç”Ÿæˆç­¾åçš„éšæœºä¸²
                signature: '', // å¿…å¡«ï¼Œç­¾å
                jsApiList: [
                    'updateAppMessageShareData',
                    'updateTimelineShareData',
                    'onMenuShareAppMessage',
                    'onMenuShareTimeline'
                ] // å¿…å¡«ï¼Œéœ€è¦ä½¿ç”¨çš„JSæ¥å£åˆ—è¡¨
            });

            wx.ready(function() {
                // å¾®ä¿¡åˆ†äº«åˆ°æœ‹å‹åœˆ
                wx.updateTimelineShareData({
                    title: shareConfig.title,
                    link: shareConfig.link,
                    imgUrl: shareConfig.imgUrl,
                    success: shareConfig.success
                });

                // å¾®ä¿¡åˆ†äº«ç»™æœ‹å‹
                wx.updateAppMessageShareData({
                    title: shareConfig.title,
                    desc: shareConfig.desc,
                    link: shareConfig.link,
                    imgUrl: shareConfig.imgUrl,
                    success: shareConfig.success
                });

                // å…¼å®¹æ—§ç‰ˆæœ¬
                wx.onMenuShareTimeline({
                    title: shareConfig.title,
                    link: shareConfig.link,
                    imgUrl: shareConfig.imgUrl,
                    success: shareConfig.success
                });

                wx.onMenuShareAppMessage({
                    title: shareConfig.title,
                    desc: shareConfig.desc,
                    link: shareConfig.link,
                    imgUrl: shareConfig.imgUrl,
                    success: shareConfig.success
                });
            });

            wx.error(function(res) {
                console.log('å¾®ä¿¡JS-SDKé…ç½®å¤±è´¥:', res);
            });
        }

        // æ£€æµ‹æ˜¯å¦åœ¨å¾®ä¿¡ä¸­
        function isWechat() {
            return /micromessenger/i.test(navigator.userAgent);
        }
        // å…¨å±€å˜é‡
        let targetName = '';
        let currentQuestion = 0;
        let totalQuestions = 5;
        let collectedFlowers = [];
        let isMusicPlaying = false;
        let bgMusic, clickSound, successSound;
        let audioContext;
        let isAudioInitialized = false;
        
        let questions = [
            {
                type: 'choice',
                question: 'åœ¨ä¸€ä¸ªæ¸©æš–çš„åˆåï¼Œä½ æœ€æƒ³å’ŒTAä¸€èµ·åšä»€ä¹ˆï¼Ÿ',
                choices: ['çœ‹ä¸€æœ¬æœ‰è¶£çš„ä¹¦', 'å¬ç€éŸ³ä¹èŠå¤©', 'ä¸€èµ·åšæ‰‹å·¥', 'å®‰é™åœ°å‘å‘†'],
                responses: ['åœ¨ä¹¦é¦™ä¸­æ‰¾åˆ°å½¼æ­¤çš„çµé­‚', 'éŸ³ä¹é‡Œè—ç€æˆ‘ä»¬çš„å°ç§˜å¯†', 'ç”¨å¿ƒåˆ›é€ å±äºæˆ‘ä»¬çš„å›å¿†', 'æœ€ç¾çš„æ—¶å…‰å°±æ˜¯å’Œä½ ä¸€èµ·è™šåº¦'],
                flowers: ['ğŸ’–', 'ğŸ’•']
            },
            {
                type: 'garden',
                question: 'ç‚¹äº®æˆ‘ä»¬çš„çˆ±å¿ƒèŠ±å›­ï¼Œè®©æ¯æœµèŠ±éƒ½ç»½æ”¾ ğŸ’–',
                flowers: ['ğŸŒ¸', 'ğŸŒº', 'ğŸŒ¹']
            },
            {
                type: 'choice',
                question: 'å¦‚æœè¦ç»™TAä¸€ä¸ªå°æƒŠå–œï¼Œä½ ä¼šé€‰æ‹©ï¼Ÿ',
                choices: ['å†™ä¸€å¼ æ¸©é¦¨çš„ä¾¿æ¡', 'ç”»ä¸€å¹…ç®€å•çš„ç”»', 'åšTAå–œæ¬¢çš„ç‚¹å¿ƒ', 'æ”¶é›†ä¸€äº›ç¾ä¸½çš„å¶å­'],
                responses: ['æ–‡å­—æ˜¯å¿ƒæ„æœ€æ¸©æŸ”çš„è½½ä½“', 'æ¯ä¸€ç¬”éƒ½ç”»ç€å¯¹ä½ çš„å–œæ¬¢', 'çˆ±æ„è—åœ¨æ¯ä¸€å£ç”œèœœé‡Œ', 'å°±åƒæ”¶é›†ç¾å¥½ï¼Œæˆ‘æƒ³æ”¶é›†ä½ çš„ç¬‘å®¹'],
                flowers: ['ğŸ’œ', 'ğŸ’™']
            },
            {
                type: 'stars',
                question: 'æ”¶é›†å¤©ç©ºä¸­é—ªäº®çš„å°æ˜Ÿæ˜Ÿ â­',
                flowers: ['âœ¨', 'ğŸ’«', 'â­']
            },
            {
                type: 'memory',
                question: 'æ‰¾åˆ°æ‰€æœ‰ç›¸åŒçš„ç¾å¥½å›å¿† ğŸ’­',
                flowers: ['ğŸŒº', 'ğŸŒˆ', 'â˜€ï¸']
            }
        ];

        // åˆå§‹åŒ–
        function init() {
            createSakura();
            setInterval(addSakura, 2500);
            initAudio();
            setupViewportHeight();
            setupTouchEvents();
        }

        function setupViewportHeight() {
            // ä¿®å¤ç§»åŠ¨ç«¯ 100vh é—®é¢˜
            let vh = window.innerHeight * 0.01;
            document.documentElement.style.setProperty('--vh', `${vh}px`);
            
            window.addEventListener('resize', () => {
                let vh = window.innerHeight * 0.01;
                document.documentElement.style.setProperty('--vh', `${vh}px`);
            });
        }

        function setupTouchEvents() {
            // é˜²æ­¢åŒå‡»ç¼©æ”¾
            let lastTouchEnd = 0;
            document.addEventListener('touchend', function (event) {
                const now = (new Date()).getTime();
                if (now - lastTouchEnd <= 300) {
                    event.preventDefault();
                }
                lastTouchEnd = now;
            }, false);

            // é˜²æ­¢é•¿æŒ‰é€‰ä¸­æ–‡æœ¬
            document.addEventListener('selectstart', function(e) {
                e.preventDefault();
            });

            // é˜²æ­¢ä¸‹æ‹‰åˆ·æ–°
            document.addEventListener('touchmove', function(e) {
                if (e.touches.length > 1) {
                    e.preventDefault();
                }
            }, { passive: false });
        }

        function initAudio() {
            bgMusic = document.getElementById('bgMusic');
            clickSound = document.getElementById('clickSound');
            successSound = document.getElementById('successSound');
            
            // è®¾ç½®éŸ³é‡
            if (bgMusic) bgMusic.volume = 0.3;
            if (clickSound) clickSound.volume = 0.5;
            if (successSound) successSound.volume = 0.6;
            
            // ç§»åŠ¨ç«¯éŸ³é¢‘éœ€è¦ç”¨æˆ·äº¤äº’åæ‰èƒ½æ’­æ”¾
            document.addEventListener('touchstart', initAudioContext, { once: true });
            document.addEventListener('click', initAudioContext, { once: true });
        }

        function initAudioContext() {
            if (!isAudioInitialized) {
                // é¢„åŠ è½½éŸ³é¢‘
                if (bgMusic) {
                    bgMusic.load();
                }
                if (clickSound) {
                    clickSound.load();
                }
                if (successSound) {
                    successSound.load();
                }
                
                isAudioInitialized = true;
            }
        }

        function toggleMusic() {
            const musicControl = document.getElementById('musicControl');
            
            if (!isAudioInitialized) {
                initAudioContext();
            }
            
            if (isMusicPlaying) {
                // åœæ­¢éŸ³ä¹
                isMusicPlaying = false;
                musicControl.textContent = 'ğŸµ';
                musicControl.classList.remove('playing');
                
                if (bgMusic) {
                    bgMusic.pause();
                }
            } else {
                // æ’­æ”¾éŸ³ä¹
                isMusicPlaying = true;
                musicControl.textContent = 'ğŸ¶';
                musicControl.classList.add('playing');
                
                if (bgMusic) {
                    bgMusic.play().catch(e => {
                        console.log('éŸ³é¢‘æ’­æ”¾å¤±è´¥:', e);
                        // å¦‚æœæ’­æ”¾å¤±è´¥ï¼Œé‡ç½®çŠ¶æ€
                        isMusicPlaying = false;
                        musicControl.textContent = 'ğŸµ';
                        musicControl.classList.remove('playing');
                    });
                }
            }
        }

        function playClickSound() {
            if (!isAudioInitialized) return;
            
            try {
                if (clickSound) {
                    clickSound.currentTime = 0;
                    clickSound.play().catch(() => {}); // å¿½ç•¥æ’­æ”¾é”™è¯¯
                }
            } catch (e) {
                // é™é»˜å¤„ç†éŸ³é¢‘é”™è¯¯
            }
        }

        function playSuccessSound() {
            if (!isAudioInitialized) return;
            
            try {
                if (successSound) {
                    successSound.currentTime = 0;
                    successSound.play().catch(() => {}); // å¿½ç•¥æ’­æ”¾é”™è¯¯
                }
            } catch (e) {
                // é™é»˜å¤„ç†éŸ³é¢‘é”™è¯¯
            }
        }

        function createSakura() {
            const container = document.getElementById('sakuraContainer');
            const sakuraSymbols = ['ğŸŒ¸', 'ğŸŒº', 'ğŸŒ¹'];
            
            for (let i = 0; i < 5; i++) {
                setTimeout(() => {
                    const sakura = document.createElement('div');
                    sakura.className = 'sakura';
                    sakura.innerHTML = sakuraSymbols[Math.floor(Math.random() * sakuraSymbols.length)];
                    sakura.style.left = Math.random() * 100 + '%';
                    sakura.style.animationDuration = (Math.random() * 5 + 8) + 's';
                    container.appendChild(sakura);
                    
                    setTimeout(() => sakura.remove(), 13000);
                }, i * 400);
            }
        }

        function addSakura() {
            const container = document.getElementById('sakuraContainer');
            const sakura = document.createElement('div');
            sakura.className = 'sakura';
            sakura.innerHTML = ['ğŸŒ¸', 'ğŸŒº'][Math.floor(Math.random() * 2)];
            sakura.style.left = Math.random() * 100 + '%';
            sakura.style.animationDuration = (Math.random() * 3 + 6) + 's';
            container.appendChild(sakura);
            
            setTimeout(() => sakura.remove(), 9000);
        }

        function startGame() {
            const nameInput = document.getElementById('nameInput');
            targetName = nameInput.value.trim();
            
            if (!targetName) {
                alert('è¯·è¾“å…¥é‚£ä¸ªç‰¹åˆ«çš„äººçš„åå­—å“¦ ğŸŒ¸');
                return;
            }

            playClickSound();
            
            document.getElementById('startScreen').classList.add('hidden');
            document.getElementById('gameScreen').classList.remove('hidden');

            currentQuestion = 0;
            collectedFlowers = [];
            showQuestion();
        }

        function showQuestion() {
            if (currentQuestion >= totalQuestions) {
                endGame();
                return;
            }

            const question = questions[currentQuestion];
            document.getElementById('questionText').textContent = question.question;
            document.getElementById('nextBtn').classList.add('hidden');
            
            updateProgress();

            if (question.type === 'choice') {
                showChoiceQuestion(question);
            } else if (question.type === 'garden') {
                showGardenGame(question);
            } else if (question.type === 'stars') {
                showStarsGame(question);
            } else if (question.type === 'memory') {
                showMemoryGame(question);
            }
        }

        function showChoiceQuestion(question) {
            const content = document.getElementById('gameContent');
            content.innerHTML = '';
            
            question.choices.forEach((choice, index) => {
                const btn = document.createElement('button');
                btn.className = 'choice-btn';
                btn.textContent = choice;
                btn.onclick = () => selectChoice(index, question.responses[index], question.flowers);
                content.appendChild(btn);
            });
        }

        function selectChoice(selected, responseText, flowers) {
            const buttons = document.querySelectorAll('.choice-btn');
            buttons[selected].classList.add('correct');
            
            playSuccessSound();
            createFloatingText(responseText, 'success');
            
            buttons.forEach(btn => btn.disabled = true);
            
            setTimeout(() => {
                document.getElementById('nextBtn').classList.remove('hidden');
            }, 2500);
        }

        function showGardenGame(question) {
            const content = document.getElementById('gameContent');
            content.innerHTML = '<div class="heart-garden"><div class="heart-grid" id="heartGrid"></div></div>';
            
            const grid = document.getElementById('heartGrid');
            let bloomed = 0;
            const target = 16; // éœ€è¦ç‚¹å‡»æ‰€æœ‰å¯è§çš„èŠ±ç›†
            
            // åˆ›å»º25ä¸ªèŠ±ç›†ï¼Œä½†åªæœ‰16ä¸ªå¯è§ï¼ˆçˆ±å¿ƒå½¢çŠ¶ï¼‰
            for (let i = 0; i < 25; i++) {
                const pot = document.createElement('div');
                pot.className = 'heart-pot';
                pot.innerHTML = 'ğŸŒ±';
                
                // è·³è¿‡ä¸å¯è§çš„èŠ±ç›†
                if (pot.style.visibility === 'hidden') {
                    grid.appendChild(pot);
                    continue;
                }
                
                pot.onclick = () => {
                    if (!pot.classList.contains('bloomed')) {
                        pot.classList.add('bloomed');
                        pot.innerHTML = ['ğŸŒ¸', 'ğŸŒº', 'ğŸŒ¹'][Math.floor(Math.random() * 3)];
                        bloomed++;
                        
                        playClickSound();
                        
                        if (bloomed === target) {
                            playSuccessSound();
                            createFloatingText('æ¯ä¸€æœµèŠ±éƒ½æ‰¿è½½ç€ç¾å¥½', 'success');
                            setTimeout(() => {
                                document.getElementById('nextBtn').classList.remove('hidden');
                            }, 2000);
                        }
                    }
                };
                
                grid.appendChild(pot);
            }
        }

        function showStarsGame(question) {
            const content = document.getElementById('gameContent');
            content.innerHTML = '<div class="star-field" id="starField"></div><div style="margin-top: 10px; color: #8b5a83; font-size: 0.9rem;">ç‚¹å‡»æ”¶é›†9é¢—æ˜Ÿæ˜Ÿ</div>';
            
            let collected = 0;
            const target = 9;
            const starField = document.getElementById('starField');
            
            const spawnStar = () => {
                const star = document.createElement('div');
                star.className = 'falling-star';
                star.innerHTML = ['â­', 'âœ¨', 'ğŸ’«'][Math.floor(Math.random() * 3)];
                star.style.left = Math.random() * (starField.offsetWidth - 40) + 'px';
                
                star.onclick = () => {
                    collected++;
                    star.remove();
                    playClickSound();
                    createFloatingText(`${collected}/${target}`, 'gentle');
                    
                    if (collected >= target) {
                        clearInterval(gameInterval);
                        playSuccessSound();
                        createFloatingText('æ¯ä¸€é¢—æ˜Ÿæ˜Ÿéƒ½æ˜¯æˆ‘ä»¬çš„çº¦å®š', 'success');
                        setTimeout(() => {
                            document.getElementById('nextBtn').classList.remove('hidden');
                        }, 2000);
                    }
                };
                
                starField.appendChild(star);
                
                setTimeout(() => {
                    if (star.parentNode) star.remove();
                }, 6000);
            };

            const gameInterval = setInterval(spawnStar, 1000);
            
            setTimeout(() => {
                if (collected < target) {
                    clearInterval(gameInterval);
                    createFloatingText('æ—¶é—´åˆ°ï¼å†è¯•ä¸€æ¬¡', 'gentle');
                    setTimeout(() => showStarsGame(question), 2000);
                }
            }, 20000);
        }

        function showMemoryGame(question) {
            const content = document.getElementById('gameContent');
            const symbols = ['ğŸŒ¸', 'ğŸŒº', 'ğŸŒ¹', 'â˜€ï¸', 'ğŸŒˆ', 'ğŸ¦„', 'ğŸŒ¸', 'ğŸŒº', 'ğŸŒ¹', 'â˜€ï¸', 'ğŸŒˆ', 'ğŸ¦„'];
            let flipped = [];
            let matched = 0;
            
            content.innerHTML = '<div class="memory-grid" id="memoryGrid"></div><div style="margin-top: 10px; color: #8b5a83; font-size: 0.9rem;">æ‰¾åˆ°æ‰€æœ‰6å¯¹ç›¸åŒå›¾æ¡ˆ</div>';
            const grid = document.getElementById('memoryGrid');
            
            const shuffled = symbols.sort(() => Math.random() - 0.5);
            
            shuffled.forEach((symbol, index) => {
                const card = document.createElement('div');
                card.className = 'memory-card';
                card.innerHTML = 'ğŸ’­';
                card.dataset.symbol = symbol;
                card.dataset.index = index;
                
                card.onclick = () => {
                    if (flipped.length < 2 && !card.classList.contains('matched') && !card.classList.contains('flipped')) {
                        card.classList.add('flipped');
                        card.innerHTML = symbol;
                        flipped.push(card);
                        
                        playClickSound();
                        
                        if (flipped.length === 2) {
                            setTimeout(() => {
                                if (flipped[0].dataset.symbol === flipped[1].dataset.symbol) {
                                    flipped.forEach(c => c.classList.add('matched'));
                                    matched += 2;
                                    
                                    playSuccessSound();
                                    
                                    if (matched === 12) {
                                        createFloatingText('æ‰€æœ‰ç¾å¥½çš„å›å¿†éƒ½å€¼å¾—çè—', 'success');
                                        setTimeout(() => {
                                            document.getElementById('nextBtn').classList.remove('hidden');
                                        }, 2000);
                                    }
                                } else {
                                    flipped.forEach(c => {
                                        c.classList.remove('flipped');
                                        c.innerHTML = 'ğŸ’­';
                                    });
                                }
                                flipped = [];
                            }, 800);
                        }
                    }
                };
                
                grid.appendChild(card);
            });
        }

        function createFloatingText(text, type) {
            const float = document.createElement('div');
            float.textContent = text;
            float.style.cssText = `
                position: fixed;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                color: ${type === 'success' ? '#86efac' : '#e879f9'};
                font-size: 1.2rem;
                font-weight: 300;
                pointer-events: none;
                z-index: 1000;
                animation: gentleFloat 3s ease-out forwards;
                max-width: 300px;
                text-align: center;
                line-height: 1.5;
                padding: 10px;
                background: rgba(255, 255, 255, 0.9);
                border-radius: 15px;
                backdrop-filter: blur(10px);
                border: 1px solid rgba(232, 121, 249, 0.3);
            `;
            
            document.body.appendChild(float);
            setTimeout(() => float.remove(), 3000);
        }

        function createSparkle(x, y) {
            const sparkle = document.createElement('div');
            sparkle.className = 'sparkle';
            sparkle.innerHTML = 'âœ¨';
            sparkle.style.left = x + 'px';
            sparkle.style.top = y + 'px';
            document.getElementById('sparkles').appendChild(sparkle);
            
            setTimeout(() => sparkle.remove(), 3000);
        }

        function nextQuestion() {
            playClickSound();
            currentQuestion++;
            showQuestion();
        }

        function updateProgress() {
            const progress = (currentQuestion / totalQuestions) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
        }

        function endGame() {
            document.getElementById('gameScreen').classList.add('hidden');
            document.getElementById('resultScreen').classList.remove('hidden');

            // æ˜¾ç¤ºå®Œæ•´çš„å”¯ç¾çˆ±å¿ƒå½¢çŠ¶èŠ±ç¯
            const completeWreath = document.getElementById('completeWreath');
            completeWreath.innerHTML = `
                <div class="complete-heart-wreath">
                    <span></span><span></span><span></span><span>ğŸ’–</span><span>ğŸŒ¸</span><span>ğŸ’–</span><span></span><span></span><span></span>
                    <span></span><span>ğŸ’•</span><span>ğŸŒº</span><span>âœ¨</span><span>ğŸ’œ</span><span>âœ¨</span><span>ğŸŒº</span><span>ğŸ’•</span><span></span>
                    <span>ğŸŒ¹</span><span>ğŸ’™</span><span>ğŸŒ¸</span><span>ğŸ’«</span><span>ğŸ’–</span><span>ğŸ’«</span><span>ğŸŒ¸</span><span>ğŸ’™</span><span>ğŸŒ¹</span>
                    <span>ğŸ’œ</span><span>âœ¨</span><span>ğŸŒº</span><span>ğŸŒˆ</span><span>ğŸ’•</span><span>ğŸŒˆ</span><span>ğŸŒº</span><span>âœ¨</span><span>ğŸ’œ</span>
                    <span></span><span>ğŸŒ¸</span><span>ğŸ’–</span><span>â˜€ï¸</span><span>ğŸ’œ</span><span>â˜€ï¸</span><span>ğŸ’–</span><span>ğŸŒ¸</span><span></span>
                    <span></span><span></span><span>ğŸ’•</span><span>ğŸŒº</span><span>ğŸ’–</span><span>ğŸŒº</span><span>ğŸ’•</span><span></span><span></span>
                    <span></span><span></span><span></span><span>ğŸŒ¸</span><span>ğŸ’•</span><span>ğŸŒ¸</span><span></span><span></span><span></span>
                    <span></span><span></span><span></span><span></span><span>ğŸ’–</span><span></span><span></span><span></span><span></span>
                </div>
            `;
            
            const message = `${targetName}ï¼Œæˆ‘ä»¬ä¸€èµ·ç¼–ç»‡äº†è¿™ä¸ªç¾ä¸½çš„çˆ±å¿ƒèŠ±ç¯<br><br>æ¯ä¸€æœµèŠ±éƒ½ä»£è¡¨ç€æˆ‘å¯¹ä½ çš„å¿ƒæ„<br><br>å°±åƒè¿™ä¸ªèŠ±ç¯ä¸€æ ·ï¼Œæˆ‘çš„çˆ±æ˜¯å®Œæ•´çš„ã€æ°¸æ’çš„<br><br>æ‰€ä»¥... æ„¿æ„æ¥å—è¿™ä¸ªèŠ±ç¯ï¼Œåšæˆ‘çš„å¥³æœ‹å‹å—ï¼ŸğŸŒ¸`;
            
            document.getElementById('finalMessage').innerHTML = message;
            
            createCelebration();
        }

        function createCelebration() {
            // åˆ›å»ºåº†ç¥ç‰¹æ•ˆ
            for (let i = 0; i < 12; i++) {
                setTimeout(() => {
                    createSparkle(
                        Math.random() * window.innerWidth,
                        Math.random() * window.innerHeight
                    );
                }, i * 200);
            }
            
            // é¢å¤–çš„èŠ±ç“£é›¨
            for (let i = 0; i < 20; i++) {
                setTimeout(() => {
                    const petal = document.createElement('div');
                    petal.className = 'sakura';
                    petal.innerHTML = ['ğŸŒ¸', 'ğŸŒº', 'ğŸ’–', 'ğŸ’•'][Math.floor(Math.random() * 4)];
                    petal.style.left = Math.random() * 100 + '%';
                    petal.style.animationDuration = '4s';
                    petal.style.fontSize = '20px';
                    document.getElementById('sakuraContainer').appendChild(petal);
                    
                    setTimeout(() => petal.remove(), 4000);
                }, i * 100);
            }
        }

        function shareResult() {
            showSharePanel();
        }

        function showSharePanel() {
            document.getElementById('overlay').classList.add('show');
            document.getElementById('sharePanel').classList.add('show');
            document.body.style.overflow = 'hidden';
        }

        function hideSharePanel() {
            document.getElementById('overlay').classList.remove('show');
            document.getElementById('sharePanel').classList.remove('show');
            document.body.style.overflow = '';
        }

        function shareToWechat() {
            if (isWechat()) {
                // åœ¨å¾®ä¿¡ä¸­ï¼Œæç¤ºç”¨æˆ·ç‚¹å‡»å³ä¸Šè§’åˆ†äº«
                alert('è¯·ç‚¹å‡»å³ä¸Šè§’"..."æŒ‰é’®ï¼Œé€‰æ‹©"å‘é€ç»™æœ‹å‹"è¿›è¡Œåˆ†äº«ï¼');
            } else {
                // ä¸åœ¨å¾®ä¿¡ä¸­ï¼Œæä¾›å…¶ä»–åˆ†äº«æ–¹å¼
                copyLink();
            }
            hideSharePanel();
        }

        function shareToMoments() {
            if (isWechat()) {
                // åœ¨å¾®ä¿¡ä¸­ï¼Œæç¤ºç”¨æˆ·ç‚¹å‡»å³ä¸Šè§’åˆ†äº«
                alert('è¯·ç‚¹å‡»å³ä¸Šè§’"..."æŒ‰é’®ï¼Œé€‰æ‹©"åˆ†äº«åˆ°æœ‹å‹åœˆ"è¿›è¡Œåˆ†äº«ï¼');
            } else {
                // ä¸åœ¨å¾®ä¿¡ä¸­ï¼Œæä¾›å…¶ä»–åˆ†äº«æ–¹å¼
                copyLink();
            }
            hideSharePanel();
        }

        function copyLink() {
            const shareText = `ğŸŒ¸ ${shareConfig.title}\n${shareConfig.desc}\n${shareConfig.link}`;
            
            if (navigator.clipboard) {
                navigator.clipboard.writeText(shareText).then(() => {
                    showToast('é“¾æ¥å·²å¤åˆ¶åˆ°å‰ªè´´æ¿ï¼');
                }).catch(() => {
                    fallbackCopyTextToClipboard(shareText);
                });
            } else {
                fallbackCopyTextToClipboard(shareText);
            }
            hideSharePanel();
        }

        function fallbackCopyTextToClipboard(text) {
            const textArea = document.createElement("textarea");
            textArea.value = text;
            textArea.style.top = "0";
            textArea.style.left = "0";
            textArea.style.position = "fixed";
            document.body.appendChild(textArea);
            textArea.focus();
            textArea.select();
            
            try {
                document.execCommand('copy');
                showToast('é“¾æ¥å·²å¤åˆ¶åˆ°å‰ªè´´æ¿ï¼');
            } catch (err) {
                showToast('å¤åˆ¶å¤±è´¥ï¼Œè¯·æ‰‹åŠ¨å¤åˆ¶ï¼š' + text);
            }
            
            document.body.removeChild(textArea);
        }

        function shareToQQ() {
            const shareUrl = `https://connect.qq.com/widget/shareqq/index.html?url=${encodeURIComponent(shareConfig.link)}&title=${encodeURIComponent(shareConfig.title)}&desc=${encodeURIComponent(shareConfig.desc)}`;
            window.open(shareUrl, '_blank');
            hideSharePanel();
        }

        function showToast(message) {
            const toast = document.createElement('div');
            toast.textContent = message;
            toast.style.cssText = `
                position: fixed;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                background: rgba(0, 0, 0, 0.8);
                color: white;
                padding: 10px 20px;
                border-radius: 20px;
                font-size: 0.9rem;
                z-index: 3000;
                max-width: 80%;
                text-align: center;
                line-height: 1.4;
            `;
            
            document.body.appendChild(toast);
            setTimeout(() => {
                document.body.removeChild(toast);
            }, 2000);
        }

        function restart() {
            playClickSound();
            document.getElementById('resultScreen').classList.add('hidden');
            document.getElementById('startScreen').classList.remove('hidden');
            document.getElementById('nameInput').value = '';
            targetName = '';
            currentQuestion = 0;
            collectedFlowers = [];
        }

        // é¡µé¢åŠ è½½ååˆå§‹åŒ–
        window.addEventListener('load', function() {
            init();
            
            // å¦‚æœåœ¨å¾®ä¿¡ä¸­ï¼Œåˆå§‹åŒ–å¾®ä¿¡åˆ†äº«
            if (isWechat()) {
                // æ³¨æ„ï¼šè¿™é‡Œéœ€è¦ä»åç«¯è·å–å¾®ä¿¡JS-SDKé…ç½®
                // initWechatShare();
            }
        });
        
        // é¡µé¢å¯è§æ€§å˜åŒ–å¤„ç†ï¼ˆåˆ‡æ¢æ ‡ç­¾é¡µæ—¶æš‚åœéŸ³ä¹ï¼‰
        document.addEventListener('visibilitychange', function() {
            if (document.hidden && isMusicPlaying && bgMusic) {
                bgMusic.pause();
            } else if (!document.hidden && isMusicPlaying && bgMusic) {
                bgMusic.play().catch(() => {});
            }
        });
    </script>
</body>
</html>